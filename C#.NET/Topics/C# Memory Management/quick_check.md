---
title: C# Memory Management - –ë—ã—Å—Ç—Ä—ã–π –æ–ø—Ä–æ—Å–Ω–∏–∫
tags:
  - quick-check
  - csharp
  - memory

# üéØ –ë—ã—Å—Ç—Ä—ã–π –æ–ø—Ä–æ—Å–Ω–∏–∫: C# Memory Management
> [!tip] –ü—Ä–æ–π–¥–∏ –æ–ø—Ä–æ—Å–Ω–∏–∫ –ø–æ—Å–ª–µ –∏–∑—É—á–µ–Ω–∏—è —Ç–µ–æ—Ä–∏–∏
## –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∏
### –í–æ–ø—Ä–æ—Å 1
–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Garbage Collector –≤ .NET?
<details>
<summary>–û—Ç–≤–µ—Ç</summary>
- GC –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –ø–∞–º—è—Ç—å –æ—Ç –æ–±—ä–µ–∫—Ç–æ–≤, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ—Ç —Å—Å—ã–ª–æ–∫
- –†–∞–±–æ—Ç–∞–µ—Ç –≤ 3 –ø–æ–∫–æ–ª–µ–Ω–∏—è—Ö: Gen 0 (–º–æ–ª–æ–¥—ã–µ), Gen 1 (—Å—Ä–µ–¥–Ω–∏–µ), Gen 2 (—Å—Ç–∞—Ä—ã–µ)
- Gen 0 –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á–∞—â–µ –≤—Å–µ–≥–æ, Gen 2 —Ä–µ–∂–µ –≤—Å–µ–≥–æ
- –û–±—ä–µ–∫—Ç—ã –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–µ –ø–æ–∫–æ–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –≤—ã–∂–∏–≤–∞–Ω–∏—è —Å–±–æ—Ä–∫–∏
</details>
### –í–æ–ø—Ä–æ—Å 2
–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IDisposable?
- –ö–æ–≥–¥–∞ –∫–ª–∞—Å—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ—É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã (—Ñ–∞–π–ª—ã, —Å–æ–∫–µ—Ç—ã, –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã)
- –ö–æ–≥–¥–∞ –∫–ª–∞—Å—Å –≤–ª–∞–¥–µ–µ—Ç –æ–±—ä–µ–∫—Ç–∞–º–∏, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–º–∏ IDisposable
- –î–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–æ —Å–ª–µ–¥—É—é—â–µ–π —Å–±–æ—Ä–∫–∏ –º—É—Å–æ—Ä–∞
- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π `using` –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ —Å IDisposable
### –í–æ–ø—Ä–æ—Å 3
–í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `using` –∏ `try-finally` —Å Dispose?
- `using` ‚Äî —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π —Å–∞—Ö–∞—Ä –¥–ª—è `try-finally` —Å –≤—ã–∑–æ–≤–æ–º Dispose
- `using` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤—ã–∑–æ–≤ Dispose –¥–∞–∂–µ –ø—Ä–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–∏
- `using` –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π
- `try-finally` –Ω—É–∂–µ–Ω –¥–ª—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è
### –í–æ–ø—Ä–æ—Å 4
–ß—Ç–æ —Ç–∞–∫–æ–µ —É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ –∏ –∫–∞–∫ –µ–µ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å?
- –£—Ç–µ—á–∫–∞ ‚Äî –æ–±—ä–µ–∫—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏, —Ö–æ—Ç—è –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã
- –ü—Ä–∏—á–∏–Ω—ã: —Å–æ–±—ã—Ç–∏—è (–Ω–µ –æ—Ç–ø–∏—Å–∞–ª–∏—Å—å), —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏, —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ: –æ—Ç–ø–∏—Å–∫–∞ –æ—Ç —Å–æ–±—ã—Ç–∏–π, –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ WeakReference
### –í–æ–ø—Ä–æ—Å 5
–ß—Ç–æ —Ç–∞–∫–æ–µ Large Object Heap (LOH)?
- LOH ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å heap –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ > 85KB
- –û–±—ä–µ–∫—Ç—ã –≤ LOH –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –ø—Ä–∏ —Å–±–æ—Ä–∫–µ –º—É—Å–æ—Ä–∞
- –°–±–æ—Ä–∫–∞ LOH –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–æ–ª–Ω–æ–π —Å–±–æ—Ä–∫–µ (Gen 2)
- –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏
### –í–æ–ø—Ä–æ—Å 6
–ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞—Ç—å GC.Collect()?
- **–ù–∏–∫–æ–≥–¥–∞ –≤ production –∫–æ–¥–µ** ‚Äî GC —Å–∞–º –∑–Ω–∞–µ—Ç –∫–æ–≥–¥–∞ —Å–æ–±–∏—Ä–∞—Ç—å
- –¢–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- GC.Collect() –º–æ–∂–µ—Ç —É—Ö—É–¥—à–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –î–æ–≤–µ—Ä—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç–µ GC
### –í–æ–ø—Ä–æ—Å 7
–í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Stack –∏ Heap?
- **Stack** ‚Äî –±—ã—Å—Ç—Ä–∞—è –ø–∞–º—è—Ç—å –¥–ª—è value types –∏ —Å—Å—ã–ª–æ–∫, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- **Heap** ‚Äî –º–µ–¥–ª–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å –¥–ª—è reference types, —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è GC
- Stack –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –ø–æ —Ä–∞–∑–º–µ—Ä—É, Heap –º–æ–∂–µ—Ç —Ä–∞—Å—Ç–∏
- Stack –±—ã—Å—Ç—Ä–µ–µ, –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω; Heap –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –≥–∏–±–∫–∏–π
## üîó –ù–∞–≤–∏–≥–∞—Ü–∏—è

‚Üê [[notes|–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∫–æ–Ω—Å–ø–µ–∫—Ç—É]]
‚Üê [[../README|–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É —Ç–µ–º]]
